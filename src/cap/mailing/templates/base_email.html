{# src/cap/mailing/templates/base_email.html #}
<!doctype html>
<html lang="{{ language|default('en') }}">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="x-apple-disable-message-reformatting" />
    <meta
      name="format-detection"
      content="telephone=no,address=no,email=no,date=no,url=no"
    />
    <meta name="color-scheme" content="light dark" />
    <meta name="supported-color-schemes" content="light dark" />
    <title>{{ app_name|default("CAP") }}</title>

    <style>
      :root {
        color-scheme: light dark;
      }

      /* Badge colors (light mode baseline) */
      .type-badge {
        display: inline-block;
        padding: 4px 10px;
        border-radius: 999px;
        font:
          600 12px/1.2 -apple-system,
          BlinkMacSystemFont,
          Segoe UI,
          Roboto,
          Helvetica,
          Arial,
          sans-serif;
        letter-spacing: 0.04em;
        text-transform: uppercase;
        border: 1px solid rgba(0, 0, 0, 0.12);
        color: #111827;
        background: rgba(255, 255, 255, 0.7);
      }
      .type-auth {
        background: rgba(37, 99, 235, 0.12);
        border-color: rgba(37, 99, 235, 0.28);
        color: #6e768b;
      }
      .type-security {
        background: rgba(245, 158, 11, 0.12);
        border-color: rgba(245, 158, 11, 0.28);
        color: #8d5252;
      }
      .type-admin {
        background: rgba(139, 92, 246, 0.12);
        border-color: rgba(139, 92, 246, 0.28);
        color: #7e67a0;
      }
      .type-neutral {
        background: rgba(17, 24, 39, 0.06);
        border-color: rgba(17, 24, 39, 0.12);
        color: #c6cad1;
      }

      @media (prefers-color-scheme: dark) {
        .bg-body {
          background-color: #0b1220 !important;
        }
        .bg-card {
          background-color: #121a2b !important;
        }
        .text-primary {
          color: #e5e7eb !important;
        }
        .text-secondary {
          color: #9ca3af !important;
        }
        .link {
          color: #60a5fa !important;
        }
        .btn {
          background-color: #2563eb !important;
          color: #ffffff !important;
        }
        .divider {
          border-color: #233152 !important;
        }

        /* Badge colors (dark mode) */
        .type-badge {
          color: #ffffff !important;
          border-color: rgba(255, 255, 255, 0.18) !important;
          background: rgba(255, 255, 255, 0.1) !important;
        }
        .type-auth {
          background: rgba(96, 165, 250, 0.18) !important;
          border-color: rgba(96, 165, 250, 0.35) !important;
        }
        .type-security {
          background: rgba(251, 191, 36, 0.16) !important;
          border-color: rgba(251, 191, 36, 0.35) !important;
        }
        .type-admin {
          background: rgba(167, 139, 250, 0.16) !important;
          border-color: rgba(167, 139, 250, 0.35) !important;
        }
        .type-neutral {
          background: rgba(255, 255, 255, 0.14) !important;
          border-color: rgba(255, 255, 255, 0.22) !important;
        }
      }
    </style>
  </head>

  <body class="bg-body" style="margin: 0; padding: 0; background: #f3f4f6">
    <!-- Preheader (hidden) -->
    <div
      style="
        display: none;
        max-height: 0;
        overflow: hidden;
        mso-hide: all;
        opacity: 0;
        line-height: 1px;
        font-size: 1px;
      "
    >
      {% block preheader %}{{ translations.preheader or "" }}{% endblock %}
    </div>

    <!--[if mso]>
    <center>
      <table role="presentation" width="600" cellpadding="0" cellspacing="0" border="0">
        <tr><td>
    <![endif]-->

    <table
      role="presentation"
      width="100%"
      cellpadding="0"
      cellspacing="0"
      border="0"
      style="background: #f3f4f6"
    >
      <tr>
        <td align="center" style="padding: 24px">
          <table
            role="presentation"
            width="100%"
            cellpadding="0"
            cellspacing="0"
            border="0"
            style="
              max-width: 600px;
              background: #ffffff;
              border-radius: 10px;
              overflow: hidden;
            "
            class="bg-card"
          >
            <!-- Header -->
            <tr>
              <td align="center" style="background: #111827; padding: 20px">
                {% if cap_logo_url %}
                <img
                  src="{{ cap_logo_url }}"
                  width="120"
                  height="auto"
                  alt="{{ app_name|default('CAP') }} logo"
                  style="
                    display: block;
                    max-width: 120px;
                    width: 120px;
                    height: auto;
                    margin: 0 auto;
                  "
                />
                {% endif %}

                <div
                  style="
                    font:
                      600 20px/1.3 -apple-system,
                      BlinkMacSystemFont,
                      Segoe UI,
                      Roboto,
                      Helvetica,
                      Arial,
                      sans-serif;
                    color: #ffffff;
                    margin-top: 10px;
                  "
                >
                  {% block header_title %}{{ app_name|default("CAP") }}{%
                  endblock %}
                </div>

                {% if template_type %} {% set _tt = (template_type|string)|lower
                %} {% if _tt == "auth" %} {% set _badge_class = "type-auth" %}
                {% elif _tt == "security" %} {% set _badge_class =
                "type-security" %} {% elif _tt == "admin" %} {% set _badge_class
                = "type-admin" %} {% else %} {% set _badge_class =
                "type-neutral" %} {% endif %}

                <div
                  class="type-badge {{ _badge_class }}"
                  style="margin-top: 6px"
                >
                  {{ _tt }}
                </div>
                {% endif %}
              </td>
            </tr>

            <!-- Body -->
            <tr>
              <td style="padding: 24px; background: #f9fafb" class="bg-card">
                <div
                  class="text-primary"
                  style="
                    font:
                      400 16px/1.6 -apple-system,
                      BlinkMacSystemFont,
                      Segoe UI,
                      Roboto,
                      Helvetica,
                      Arial,
                      sans-serif;
                    color: #111827;
                  "
                >
                  {% block content %}{% endblock %}
                </div>
              </td>
            </tr>

            <!-- Divider -->
            <tr>
              <td style="padding: 0 24px">
                <hr
                  class="divider"
                  style="border: 0; border-top: 1px solid #e5e7eb; margin: 0"
                />
              </td>
            </tr>

            <!-- Footer -->
            <tr>
              <td
                align="center"
                class="text-secondary"
                style="
                  padding: 16px 24px 24px;
                  font:
                    400 12px/1.6 -apple-system,
                    BlinkMacSystemFont,
                    Segoe UI,
                    Roboto,
                    Helvetica,
                    Arial,
                    sans-serif;
                  color: #6b7280;
                "
              >
                <div>
                  {{ translations.footer_note or "You received this email
                  because it relates to your CAP account or activity." }}
                </div>

                {% if unsubscribe_url %}
                <div style="margin-top: 8px">
                  <a
                    class="link"
                    href="{{ unsubscribe_url }}"
                    style="color: #2563eb; text-decoration: none"
                  >
                    {{ translations.unsubscribe or "Unsubscribe" }}
                  </a>
                </div>
                {% endif %} {% if public_base_url %}
                <div style="margin-top: 8px">
                  <a
                    class="link"
                    href="{{ public_base_url }}"
                    style="color: #2563eb; text-decoration: none"
                  >
                    {{ public_base_url }}
                  </a>
                </div>
                {% endif %}
              </td>
            </tr>
          </table>
        </td>
      </tr>
    </table>

    <!--[if mso]>
        </td></tr></table>
    </center>
    <![endif]-->
  </body>
</html>
